(function($){window.swipe=$.swipe=function(opt){var o=$.extend({touchSelector:".c_touch",imgArray:["images/s1.jpg","images/s2.jpg","images/s1.jpg","images/s3.jpg"],linksArray:["#1","#","#","#"],time:2500,autorun:true,width:320,height:95,responsive:true,tipswrapStyle:{bottom:"10px",left:"5px"}},opt||{});var touchobj=$(o.touchSelector).length>0?$(o.touchSelector):$('<div class="c_touch"></div>'),startX=0,timer=o.time,i=0,dirvalue=0,_width=0;var obj={touchbox:null,touchlist:null,items:null,tipsitems:null,len:null,initHtml:function(){var imgContent="",iconContent="",html='<div class="c_touhmain posr oh"><ul class=" lsn c_touhlist posa nom nop w-mx clearfix">',IconHtml='<ul class="c_touchicon lsn clearfix posa nom nop tipCir">';$.each(o.imgArray,function(i){imgContent+='<li class="fl l"><a class="block fullw fullh" href="'+o.linksArray[i]+'"><img class="fullw fullh" src='+o.imgArray[i]+" /></a></li>";iconContent+='<li class="fl l posr c_tips mls"><i class="c_on round-10 w-1 h-1 block so bgw"></i></li>'});html=html+imgContent+"</ul></div>";IconHtml=IconHtml+iconContent+"</ul>";touchobj.addClass("posr").append(html+IconHtml)},initSelector:function(){obj.touchbox=touchobj.find(".c_touhmain");obj.touchlist=touchobj.find(".c_touhlist");obj.tipsitems=touchobj.find(".c_tips");obj.items=obj.touchlist.find("li");obj.len=obj.items.length},setWidth:function(){if(o.responsive){_width=touchobj.width()}else{_width=o.width}},getWidth:function(){return _width},initUI:function(){obj.initSelector();obj.setWidth();var w=obj.getWidth();obj.touchbox.height(o.height).width(w);obj.touchlist.height(o.height);obj.touchlist.find("li").height(o.height).width(w);obj.tipsitems.first().find(".c_on").removeClass("bgw").addClass("bgy");touchobj.find(".c_touchicon").css(o.tipswrapStyle)},bindEvent:function(){touchobj[0].addEventListener("touchstart",obj.touchStart,false);touchobj[0].addEventListener("touchmove",obj.touchMove,false);touchobj[0].addEventListener("touchend",obj.touchEnd,false)},lazyLoad:function(index,items){var img=items.eq(index).find("img");if(img.attr("data-src")){img.attr("src",img.attr("data-src")).removeAttr("data-src")}},touchStart:function(evt){obj.lazyLoad(i+1,obj.items);clearInterval(obj.timeHanlder);var touch=evt.touches[0];startX=parseInt(touch.pageX,10)},touchMove:function(evt){evt.preventDefault();clearInterval(obj.timeHanlder);var w=obj.getWidth();var touch=evt.touches[0];dirvalue=parseInt((touch.pageX-startX),10);if(dirvalue<0){obj.touchlist.find("li").slice(obj.len).remove()}obj.touchlist.css({"left":-i*w+dirvalue})},tipShow:function(){i===obj.len?i=0:i;obj.tipsitems.find(".c_on").addClass("bgw").removeClass("bgy");obj.tipsitems.eq(i).find(".c_on").addClass("bgy").removeClass("bgw")},_touchends:function(){if(dirvalue===0){return}var w=obj.getWidth();if(dirvalue<0){i++;i>=obj.len?i=obj.len-1:i}else{i--;i<0?i=0:i}obj.touchlist.animate({"left":-i*w},function(){if(o.autorun){obj.touchlist.find("li").slice(0,1).clone(true).appendTo(".c_touhlist");obj.timeHanlder=setInterval(obj.setTime,2*timer)}});obj.tipShow();dirvalue=0},touchEnd:function(evt){obj._touchends()},setTime:function(){var w=obj.getWidth();i++;if(i>obj.len-1){obj.touchlist.stop().animate({"left":-i*w},function(){i=0;obj.touchlist.css({"left":0})})}else{obj.touchlist.stop().animate({"left":-i*w})}obj.lazyLoad(i,obj.items);obj.tipShow()},init:function(){obj.initHtml();obj.initUI();if(util.supportTouch){obj.bindEvent()}if(o.autorun){obj.touchlist.find("li").slice(0,1).clone(true).appendTo(".c_touhlist");obj.timeHanlder=setInterval(obj.setTime,timer)}},getHtml:function(){return touchobj}};obj.init();return obj.getHtml()}})(window.jQuery||window.Zepto);